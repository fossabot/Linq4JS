"use strict";var Linq4JS;!function(Linq4JS){var GeneratedEntity=function(){function GeneratedEntity(){}return GeneratedEntity}();Linq4JS.GeneratedEntity=GeneratedEntity}(Linq4JS||(Linq4JS={}));var Linq4JS;!function(Linq4JS){var Helper=function(){function Helper(){}return Helper.ConvertStringFunction=function(functionString){if(0===functionString.length)throw new Error("Linq4JS: Cannot convert empty string to function");var varnameString=functionString.substring(0,functionString.indexOf("=>")).replace(" ","").replace("(","").replace(")",""),varnames=varnameString.split(","),func=functionString.substring(functionString.indexOf("=>")+"=>".length).replace("{","").replace("}","").split(".match(//gi)").join("");return null==func.match(/return(?=([^\"']*[\"'][^\"']*[\"'])*[^\"']*$)/g)&&(func="return "+func),Function.apply(void 0,varnames.concat([func]))},Helper.ConvertFunction=function(testFunction){var result;if("function"==typeof testFunction)result=testFunction;else{if("string"!=typeof testFunction)throw new Error("Linq4JS: Cannot use '"+testFunction+"' as function");result=Linq4JS.Helper.ConvertStringFunction(testFunction)}return result},Helper.OrderCompareFunction=function(valueSelector,a,b,invert){var value_a=valueSelector(a),value_b=valueSelector(b),type=typeof value_a;if("string"===type){var value_a_string=value_a;value_a_string=value_a_string.toLowerCase();var value_b_string=value_b;return value_b_string=value_b_string.toLowerCase(),value_a_string>value_b_string?invert===!0?-1:1:value_a_string<value_b_string?invert===!0?1:-1:0}if("number"===type){var value_a_number=value_a,value_b_number=value_b;return invert===!0?value_b_number-value_a_number:value_a_number-value_b_number}if("boolean"===type){var value_a_bool=value_a,value_b_bool=value_b;return value_a_bool===value_b_bool?0:invert===!0?value_a_bool?1:-1:value_a_bool?-1:1}throw new Error("Linq4JS: Cannot map type '"+type+"' for compare")},Helper}();Linq4JS.Helper=Helper}(Linq4JS||(Linq4JS={})),Array.prototype.Add=function(object,generateId){var that=this;if(null!=object){if(1==generateId){var newIndex_1,castedObject=object,last=that.LastOrDefault();if(null!=last){for(newIndex_1=null!=last._GeneratedId_?last._GeneratedId_:1;that.Any(function(x){return x._GeneratedId_===newIndex_1});)newIndex_1++;castedObject._GeneratedId_=newIndex_1}else castedObject._GeneratedId_=1}that.push(object)}return that},Array.prototype.AddRange=function(objects,generateId){var that=this;return objects.ForEach(function(x){that.Add(x,generateId)}),that},Array.prototype.Aggregate=function(method,startVal){var result,that=this;result=null!=startVal?startVal:"";var methodFunction=Linq4JS.Helper.ConvertFunction(method);return that.ForEach(function(x){result=methodFunction(result,x)}),result},Array.prototype.All=function(filter){var that=this;return that.Count(filter)===that.Count()},Array.prototype.Any=function(filter){var that=this;return that.Count(filter)>0},Array.prototype.Average=function(selector,filter){var that=this,result=0,array=that;return null!=filter&&(array=array.Where(filter)),null!=selector&&(array=array.Select(selector)),array.ForEach(function(x){result+=x}),result/array.Count()},Array.prototype.Clone=function(){for(var that=this,newArray=[],_i=0,that_1=that;_i<that_1.length;_i++){var obj=that_1[_i];newArray.Add(obj)}return newArray},Array.prototype.Concat=function(array){var that=this;return that=that.concat(array)},Array.prototype.Contains=function(object){var that=this;return that.Any(function(x){return x===object})},Array.prototype.Count=function(filter){var that=this;return null!=filter?that.Where(filter).length:that.length},Array.prototype.Distinct=function(valueSelector){var that=this;if(null!=valueSelector){var valueSelectorFunction_1=Linq4JS.Helper.ConvertFunction(valueSelector);return that.Where(function(x,i){return that.FindIndex(function(y){return valueSelectorFunction_1(y)===valueSelectorFunction_1(x)})===i})}return that.Where(function(x,i){return that.FindIndex(function(y){return y===x})===i})},Array.prototype.FindIndex=function(filter){var that=this;if(null!=filter){for(var filterFunction=Linq4JS.Helper.ConvertFunction(filter),i=0;i<that.length;i++){var obj=that[i];if(filterFunction(obj)===!0)return i}return-1}throw new Error("Linq4JS: You must define a filter")},Array.prototype.FindLastIndex=function(filter){var that=this;if(null!=filter){for(var filterFunction=Linq4JS.Helper.ConvertFunction(filter),i=that.length-1;i>=0;i--){var obj=that[i];if(filterFunction(obj)===!0)return i}return-1}throw new Error("Linq4JS: You must define a filter")},Array.prototype.First=function(filter){var that=this;if(null!=filter){var result=that.Where(filter);if(result.Any())return result.Get(0);throw new Error("Linq4JS: The First Entry was not found")}if(that.Any())return that.Get(0);throw new Error("Linq4JS: The First Entry was not found")},Array.prototype.FirstOrDefault=function(filter){var that=this;if(null!=filter){var result=that.Where(filter);return result.Any()?result.Get(0):null}return that.Any()?that.Get(0):null},Array.prototype.ForEach=function(action){for(var that=this,actionFunction=Linq4JS.Helper.ConvertFunction(action),i=0;i<that.length;i++){var result=actionFunction(that[i],i);if(null!=result&&result===!0)break}return that},Array.prototype.Get=function(index){var that=this;return that[index]},Array.prototype.GroupBy=function(selector){var prev,that=this,selectorFunction=Linq4JS.Helper.ConvertFunction(selector),newArray=[],ordered=that.OrderBy(selectorFunction),newSub=[];return ordered.ForEach(function(x){null!=prev?selectorFunction(prev)!==selectorFunction(x)&&(newArray.Add(newSub),newSub=[],newSub.GroupValue=selectorFunction(x)):newSub.GroupValue=selectorFunction(x),newSub.Add(x),prev=x}),newSub.Count()>0&&newArray.Add(newSub),newArray},Array.prototype.Insert=function(object,index){var that=this;return that.splice(index,0,object),that},Array.prototype.Intersect=function(array){var that=this,newArray=[];return that.ForEach(function(x){array.Contains(x)&&newArray.Add(x)}),array.ForEach(function(x){that.Contains(x)&&newArray.Add(x)}),newArray.Distinct()},Array.prototype.Join=function(char,selector){var that=this,array=[];return null!=selector&&(array=that.Select(selector)),array.join(char)},Array.prototype.Last=function(filter){var that=this;if(null!=filter){var result=that.Where(filter);if(result.Any())return result.Get(result.length-1);throw new Error("Linq4JS: The Last Entry was not found")}if(that.Any())return that.Get(that.length-1);throw new Error("Linq4JS: The Last Entry was not found")},Array.prototype.LastOrDefault=function(filter){var that=this;if(null!=filter){var result=that.Where(filter);return result.Any()?result.Get(result.length-1):null}return that.Any()?that.Get(that.length-1):null},Array.prototype.Max=function(valueSelector){var that=this;if(null!=valueSelector){var valueSelectorFunction=Linq4JS.Helper.ConvertFunction(valueSelector);return that.OrderBy(valueSelectorFunction).LastOrDefault()}return that.OrderBy(function(x){return x}).LastOrDefault()},Array.prototype.Min=function(valueSelector){var that=this;if(null!=valueSelector){var valueSelectorFunction=Linq4JS.Helper.ConvertFunction(valueSelector);return that.OrderBy(valueSelectorFunction).FirstOrDefault()}return that.OrderBy(function(x){return x}).FirstOrDefault()},Array.prototype.Move=function(oldIndex,newIndex){var that=this;return that.splice(newIndex,0,that.splice(oldIndex,1)[0]),that},Array.prototype.OrderBy=function(valueSelector){var that=this,valueSelectorFunction=Linq4JS.Helper.ConvertFunction(valueSelector),ordered=that.Clone();return ordered.Order=new Array(new Linq4JS.OrderEntry(Linq4JS.OrderDirection.Ascending,valueSelectorFunction)),ordered.sort(function(a,b){return Linq4JS.Helper.OrderCompareFunction(valueSelectorFunction,a,b,!1)})},Array.prototype.OrderByDescending=function(valueSelector){var that=this,valueSelectorFunction=Linq4JS.Helper.ConvertFunction(valueSelector),ordered=that.Clone();return ordered.Order=new Array(new Linq4JS.OrderEntry(Linq4JS.OrderDirection.Descending,valueSelectorFunction)),ordered.sort(function(a,b){return Linq4JS.Helper.OrderCompareFunction(valueSelectorFunction,a,b,!0)})},Array.prototype.Range=function(start,length){for(var that=this,newArray=[],i=start;i<start+length;i++)newArray.Add(that.Get(i));return newArray},Array.prototype.Remove=function(object,primaryKeySelector){var targetIndex,that=this;if(null==object)throw new Error("Linq4JS: The object cannot be null");var castedObject=object;if(null!=primaryKeySelector){var selector_1=Linq4JS.Helper.ConvertFunction(primaryKeySelector);targetIndex=that.FindIndex(function(x){return selector_1(x)===selector_1(object)})}else targetIndex=null!=castedObject._GeneratedId_?that.FindIndex(function(x){return x._GeneratedId_===castedObject._GeneratedId_}):null!=castedObject.Id?that.FindIndex(function(x){return x.Id===castedObject.Id}):that.FindIndex(function(x){return x===object});if(targetIndex===-1)throw new Error("Linq4JS: Nothing found to Remove");return that.splice(targetIndex,1),that},Array.prototype.RemoveRange=function(objects,primaryKeySelector){var that=this;if(null!=primaryKeySelector){var selector_2=Linq4JS.Helper.ConvertFunction(primaryKeySelector);objects.ForEach(function(x){that.Remove(x,selector_2)})}else objects.ForEach(function(x){that.Remove(x)});return that},Array.prototype.Repeat=function(object,count){for(var that=this,i=0;i<count;i++)that.Add(object);return that},Array.prototype.Reverse=function(){var that=this;return that.reverse()},Array.prototype.Select=function(selector){for(var that=this,selectorFunction=Linq4JS.Helper.ConvertFunction(selector),newArray=new Array,_i=0,that_2=that;_i<that_2.length;_i++){var obj=that_2[_i];newArray.Add(selectorFunction(obj))}return newArray},Array.prototype.SequenceEqual=function(array){var that=this;if(that.Count()!==array.Count())return!1;for(var i=0;i<that.length;i++)for(var keys=Object.keys(that[i]),_i=0,keys_1=keys;_i<keys_1.length;_i++){var key=keys_1[_i];if(that[i][key]!==array[i][key])return!1}return!0},Array.prototype.Skip=function(count){var that=this;return that.slice(count,that.Count())},Array.prototype.Sum=function(selector,filter){var that=this,result=0,array=[];return null!=filter&&(array=that.Where(filter)),null!=selector&&(array=that.Select(selector)),array.ForEach(function(x){result+=x}),result},Array.prototype.Take=function(count){var that=this;return that.slice(0,count)},Array.prototype.TakeWhile=function(condition,initial,after){var that=this,conditionFunction=Linq4JS.Helper.ConvertFunction(condition),storage={};if(null!=initial){var initialFunction=Linq4JS.Helper.ConvertFunction(initial);initialFunction(storage)}var afterFunction=null;null!=after&&(afterFunction=Linq4JS.Helper.ConvertFunction(after));for(var result=[],_i=0,that_3=that;_i<that_3.length;_i++){var object=that_3[_i];if(conditionFunction(object,storage)!==!0)break;result.Add(object),null!=afterFunction&&afterFunction(object,storage)}return result},Array.prototype.ThenBy=function(valueSelector){var that=this,valueSelectorFunction=Linq4JS.Helper.ConvertFunction(valueSelector);if(null==that.Order||0===that.Order.Count())throw new Error("Linq4JS: Please call OrderBy or OrderByDescending before ThenBy");var ordered=that;return ordered.Order.Add(new Linq4JS.OrderEntry(Linq4JS.OrderDirection.Ascending,valueSelectorFunction)),ordered.sort(function(a,b){for(var _i=0,_a=ordered.Order;_i<_a.length;_i++){var entry=_a[_i],result=Linq4JS.Helper.OrderCompareFunction(entry.ValueSelector,a,b,entry.Direction===Linq4JS.OrderDirection.Descending);if(0!==result)return result}return 0})},Array.prototype.ThenByDescending=function(valueSelector){var that=this,valueSelectorFunction=Linq4JS.Helper.ConvertFunction(valueSelector);if(null==that.Order||0===that.Order.Count())throw new Error("Linq4JS: Please call OrderBy or OrderByDescending before ThenByDescending");var ordered=that;return ordered.Order.Add(new Linq4JS.OrderEntry(Linq4JS.OrderDirection.Descending,valueSelectorFunction)),ordered.sort(function(a,b){for(var _i=0,_a=ordered.Order;_i<_a.length;_i++){var entry=_a[_i],result=Linq4JS.Helper.OrderCompareFunction(entry.ValueSelector,a,b,entry.Direction===Linq4JS.OrderDirection.Descending);if(0!==result)return result}return 0})},Array.prototype.ToDictionary=function(keySelector,valueSelector){var that=this,keySelectorFunction=Linq4JS.Helper.ConvertFunction(keySelector),returnObject={};if(null!=valueSelector){var valueSelectorFunction_2=Linq4JS.Helper.ConvertFunction(valueSelector);that.ForEach(function(x){returnObject[keySelectorFunction(x)]=valueSelectorFunction_2(x)})}else that.ForEach(function(x){returnObject[keySelectorFunction(x)]=x});return returnObject},Array.prototype.Union=function(array){var that=this;return that.Concat(array).Distinct()},Array.prototype.Update=function(object,primaryKeySelector){var targetIndex,that=this;if(null==object)throw new Error("Linq4JS: The object cannot be null");var castedObject=object;if(null!=primaryKeySelector){var selector_3=Linq4JS.Helper.ConvertFunction(primaryKeySelector);targetIndex=that.FindIndex(function(x){return selector_3(x)===selector_3(object)})}else targetIndex=null!=castedObject._GeneratedId_?that.FindIndex(function(x){return x._GeneratedId_===castedObject._GeneratedId_}):null!=castedObject.Id?that.FindIndex(function(x){return x.Id===castedObject.Id}):that.FindIndex(function(x){return x===object});if(targetIndex===-1)throw new Error("Linq4JS: Nothing found to Update");for(var keys=Object.keys(object),_i=0,keys_2=keys;_i<keys_2.length;_i++){var key=keys_2[_i];"Id"!==key&&(that[targetIndex][key]=object[key])}return that},Array.prototype.UpdateRange=function(objects,primaryKeySelector){var that=this;if(null!=primaryKeySelector){var selector_4=Linq4JS.Helper.ConvertFunction(primaryKeySelector);objects.ForEach(function(x){that.Update(x,selector_4)})}else objects.ForEach(function(x){that.Update(x)});return that},Array.prototype.Where=function(filter){var that=this;if(null!=filter){for(var filterFunction=Linq4JS.Helper.ConvertFunction(filter),newArray=[],i=0;i<that.length;i++){var obj=that[i];filterFunction(obj,i)===!0&&newArray.push(obj)}return newArray}throw new Error("Linq4JS: You must define a filter")},Array.prototype.Zip=function(array,result){for(var that=this,resultFunction=Linq4JS.Helper.ConvertFunction(result),newArray=new Array,i=0;i<that.length;i++)null!=array[i]&&newArray.Add(resultFunction(that[i],array[i]));return newArray};var Linq4JS;!function(Linq4JS){var OrderEntry=function(){function OrderEntry(_direction,_valueSelector){this.Direction=_direction,this.ValueSelector=_valueSelector}return OrderEntry}();Linq4JS.OrderEntry=OrderEntry;var OrderDirection;!function(OrderDirection){OrderDirection[OrderDirection.Ascending=0]="Ascending",OrderDirection[OrderDirection.Descending=1]="Descending"}(OrderDirection=Linq4JS.OrderDirection||(Linq4JS.OrderDirection={}))}(Linq4JS||(Linq4JS={}));